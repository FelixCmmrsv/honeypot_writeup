Я выбрал [Cowrie](https://cowrie.readthedocs.io/en/latest/index.html) как honeypot среднего и высокого уровня взаимодействия с пользователем, который заменяет стандартный SSH порт 22 на собственный. С помощью него можно наблюдать за действиями злоумышленников в системе, который симулирует стандартный UNIX систему.

#### Установка
Для проверки этого ханипота я воспользуюсь Google Cloud Platform, который будет хостить виртуальную машину.

Чтобы поставить cowrie на машину, нужно установить файлы с [репозитория GitHub](https://github.com/cowrie/cowrie). Для удобства, я создам отдельного пользователя, чтобы он держал программу в запущенном виде:
```
$ sudo adduser --disabled-password cowrie
$ sudo su - cowrie
$ git clone http://github.com/cowrie/cowrie
$ cd cowrie
```

Следуя документации, нам нужно создать на pyhton virtual environment и установить необходимые библиотеки и пакеты:
```
$ python -m venv cowrie-env
$ source cowrie-env/bin/activate
(cowrie-env) $ python -m pip install --upgrade pip
(cowrie-env) $ python -m pip install --upgrade -r requirements.txt
```

Теперь нужно поменять файлы конфигурации, чтобы он использовал порт 22 (по умолчанию стоит порт 2222), но перед этим нужно поменять порт у самого SSH:
```
$ sudo nano /etc/ssh/sshd_config
```
Там вы найдете такую закомментированную строку:
```
#Port 22
```
Нужно убрать комментарий и поменять на любой другой угодный вам число. Я выбрал 65507:
```
Port 65507
```
Теперь обновляем SSH:
```
$ sudo systemctl restart ssh
```
И меняем конфигурацию:
```
$ nano cowrie/etc/cowrie.cfg.dist
[ssh]
listen_endpoints = tcp:22:interface=0.0.0.0
$ sudo apt-get install authbind
$ sudo touch /etc/authbind/byport/22
$ sudo chown cowrie:cowrie /etc/authbind/byport/22
$ sudo chmod 770 /etc/authbind/byport/22
```

Все готово! Саму программу нужно запускать следующим образом:
```
$ bin/cowrie start
```

Все логи хранятся в папке 'var/log/cowrie'

#### Хостинг машины
Для того, чтобы злоумышленник мог попасться на ловушку мы должны зайти на сайт Google Cloud Platform и начать хостить виртуальную машину. В поиске ищем 'VPC network' и переходим по вкладке 'IP adressess'. Там вы ищите External access type своей виртуальной машины и на его левой части нажимаете на три точки, в котором выбираете 'Promote to static IP adressess'. Вот и все!

#### Как все выглядит
Представим ситуацию. Ваш бот сканируя просторы интернета наткнулся на сеть 34.88.200.139 с открытым SSH на дефолтном порте 22. Все выглядит простенько. Вы включаете программу брутфорса паролей для root, чтобы получить к нему доступ. Через миллисекунду с запуска программы он получает доступ к системе и вы радуетесь, что тут самая слабая защита в мире. Устанавливаете программы для майнинга, ищите интересные файлы и тому подобное. А что происходит на самом деле?

Cowrie принимает на порту 22 любые значения для username и password, поэтому программа брутфорса сразу же найдет пароль. Все файлы ненастоящие. Все действия злоумышленника записываются. Вы обезьянка с цирка, которую снимают на телешоу.
